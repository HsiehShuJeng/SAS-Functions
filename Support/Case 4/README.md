This is a process combining DATA STEP, PROC SQL, SAS MACRO FUNCTION which can help achieve automatic categorization.